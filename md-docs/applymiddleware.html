<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />

    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>applymiddleware</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
    </style>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/bgoonz/GIT-CDN-FILES/prism.css"
    />

    <script
      async
      defer
      src="https://cdn.jsdelivr.net/gh/bgoonz/GIT-CDN-FILES/prism.js"
    ></script>
  </head>
  <body>
    <h1 id="applymiddleware...middleware">
      <span
        id="applymiddlewaremiddleware"
        class="anchor enhancedAnchor_2LWZ"
      ></span
      ><code class="language-js">applyMiddleware(...middleware)</code
      ><a
        href="#applymiddlewaremiddleware"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h1>
    <p>
      Middleware is the suggested way to extend Redux with custom functionality.
      Middleware lets you wrap the store’s
      <a href="https://redux.js.org/api/store#dispatchaction"
        ><code class="language-js">dispatch</code></a
      >
      method for fun and profit. The key feature of middleware is that it is
      composable. Multiple middleware can be combined together, where each
      middleware requires no knowledge of what comes before or after it in the
      chain.
    </p>
    <p>
      The most common use case for middleware is to support asynchronous actions
      without much boilerplate code or a dependency on a library like
      <a href="https://github.com/Reactive-Extensions/RxJS">Rx</a>. It does so
      by letting you dispatch
      <a
        href="https://redux.js.org/understanding/thinking-in-redux/glossary#async-action"
        >async actions</a
      >
      in addition to normal actions.
    </p>
    <p>
      For example,
      <a href="https://github.com/gaearon/redux-thunk">redux-thunk</a> lets the
      action creators invert control by dispatching functions. They would
      receive
      <a href="https://redux.js.org/api/store#dispatchaction"
        ><code class="language-js">dispatch</code></a
      >
      as an argument and may call it asynchronously. Such functions are called
      <em>thunks</em>. Another example of middleware is
      <a href="https://github.com/acdlite/redux-promise">redux-promise</a>. It
      lets you dispatch a
      <a
        href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Promise"
        >Promise</a
      >
      async action, and dispatches a normal action when the Promise resolves.
    </p>
    <p>
      Middleware is not baked into
      <a href="https://redux.js.org/api/createstore"
        ><code class="language-js">createStore</code></a
      >
      and is not a fundamental part of the Redux architecture, but we consider
      it useful enough to be supported right in the core. This way, there is a
      single standard way to extend
      <a href="https://redux.js.org/api/store#dispatchaction"
        ><code class="language-js">dispatch</code></a
      >
      in the ecosystem, and different middleware may compete in expressiveness
      and utility.
    </p>
    <h4 id="arguments">
      <span id="arguments" class="anchor enhancedAnchor_2LWZ"></span>Arguments<a
        href="#arguments"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h4>
    <ul>
      <li>
        <code class="language-js">...middleware</code> (<em>arguments</em>):
        Functions that conform to the Redux <em>middleware API</em>. Each
        middleware receives
        <a href="https://redux.js.org/api/store"
          ><code class="language-js">Store</code></a
        >’s
        <a href="https://redux.js.org/api/store#dispatchaction"
          ><code class="language-js">dispatch</code></a
        >
        and
        <a href="https://redux.js.org/api/store#getState"
          ><code class="language-js">getState</code></a
        >
        functions as named arguments, and returns a function. That function will
        be given the <code class="language-js">next</code> middleware’s dispatch
        method, and is expected to return a function of
        <code class="language-js">action</code> calling
        <code class="language-js">next(action)</code> with a potentially
        different argument, or at a different time, or maybe not calling it at
        all. The last middleware in the chain will receive the real store’s
        <a href="https://redux.js.org/api/store#dispatchaction"
          ><code class="language-js">dispatch</code></a
        >
        method as the <code class="language-js">next</code> parameter, thus
        ending the chain. So, the middleware signature is
        <code class="language-js"
          >({ getState, dispatch }) =&gt; next =&gt; action</code
        >.
      </li>
    </ul>
    <h4 id="returns">
      <span id="returns" class="anchor enhancedAnchor_2LWZ"></span>Returns<a
        href="#returns"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h4>
    <p>
      (<em>Function</em>) A store enhancer that applies the given middleware.
      The store enhancer signature is
      <code class="language-js">createStore =&gt; createStore</code> but the
      easiest way to apply it is to pass it to
      <a href="https://redux.js.org/api/createstore"
        ><code class="language-js">createStore()</code></a
      >
      as the last <code class="language-js">enhancer</code> argument.
    </p>
    <h4 id="example-custom-logger-middleware">
      <span
        id="example-custom-logger-middleware"
        class="anchor enhancedAnchor_2LWZ"
      ></span
      >Example: Custom Logger Middleware<a
        href="#example-custom-logger-middleware"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h4>
    <p>
      <span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">{</span
      ><span class="token imports"> createStore</span
      ><span class="token imports punctuation" style="color: #f8f8f2">,</span
      ><span class="token imports"> applyMiddleware </span
      ><span class="token imports punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘redux’</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span><span class="token imports">todos</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘./reducers’</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">logger</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter punctuation" style="color: #f8f8f2">{</span
      ><span class="token parameter"> getState </span
      ><span class="token parameter punctuation" style="color: #f8f8f2">}</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token parameter">next</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token parameter">action</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token console class-name">console</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >log</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘will dispatch’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> action</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// Call the next dispatch method in the middleware chain.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">const</span
      ><span class="token plain"> returnValue </span
      ><span class="token operator" style="color: #f8f8f2">=</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">next</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">action</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token console class-name">console</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >log</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e"
        >‘state after dispatch’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">getState</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// This will likely be the action itself, unless</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// a middleware further in chain changed it.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> returnValue</span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">const</span
      ><span class="token plain"> store </span
      ><span class="token operator" style="color: #f8f8f2">=</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">createStore</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">todos</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">[</span
      ><span class="token string" style="color: #a6e22e">‘Use Redux’</span
      ><span class="token punctuation" style="color: #f8f8f2">]</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">applyMiddleware</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">logger</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain">store</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> type</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘ADD_TODO’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> text</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e"
        >‘Understand the middleware’</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// (These lines will be logged by the middleware:)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// will dispatch: { type: ‘ADD_TODO’, text: ‘Understand the middleware’
        }</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// state after dispatch: [ ‘Use Redux’, ‘Understand the middleware’
        ]</span
      >
    </p>
    <p>Copy</p>
    <h4 id="example-using-thunk-middleware-for-async-actions">
      <span
        id="example-using-thunk-middleware-for-async-actions"
        class="anchor enhancedAnchor_2LWZ"
      ></span
      >Example: Using Thunk Middleware for Async Actions<a
        href="#example-using-thunk-middleware-for-async-actions"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h4>
    <p>
      <span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">{</span
      ><span class="token imports"> createStore</span
      ><span class="token imports punctuation" style="color: #f8f8f2">,</span
      ><span class="token imports"> combineReducers</span
      ><span class="token imports punctuation" style="color: #f8f8f2">,</span
      ><span class="token imports"> applyMiddleware </span
      ><span class="token imports punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘redux’</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span><span class="token imports">thunk</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘redux-thunk’</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports operator" style="color: #f8f8f2">*</span
      ><span class="token imports"> </span
      ><span class="token imports keyword module" style="color: #f92672"
        >as</span
      ><span class="token imports"> reducers</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘./reducers’</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">const</span
      ><span class="token plain"> reducer </span
      ><span class="token operator" style="color: #f8f8f2">=</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">combineReducers</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">reducers</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// applyMiddleware supercharges createStore with middleware:</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">const</span
      ><span class="token plain"> store </span
      ><span class="token operator" style="color: #f8f8f2">=</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">createStore</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">reducer</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">applyMiddleware</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">thunk</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >fetchSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">fetch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e"
        >‘https://www.google.com/search?q=secret+sauce’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// These are the normal action creators you have seen so far.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// The actions they return can be dispatched without any
        middleware.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// However, they only express “facts” and not the “async flow”.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">makeASandwich</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">forPerson</span
      ><span class="token parameter punctuation" style="color: #f8f8f2">,</span
      ><span class="token parameter"> secretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> type</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘MAKE_SANDWICH’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain"> secretSauce</span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">apologize</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">fromPerson</span
      ><span class="token parameter punctuation" style="color: #f8f8f2">,</span
      ><span class="token parameter"> toPerson</span
      ><span class="token parameter punctuation" style="color: #f8f8f2">,</span
      ><span class="token parameter"> error</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> type</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘APOLOGIZE’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> fromPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> toPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain"> error</span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">withdrawMoney</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">amount</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> type</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘WITHDRAW’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain"> amount</span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// Even without middleware, you can dispatch an action:</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain">store</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874">withdrawMoney</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token number" style="color: #ae81ff">100</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// But what do you do when you need to start an asynchronous
        action,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// such as an API call, or a router transition?</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2">// Meet thunks.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// A thunk is a function that returns a function.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// This is a thunk.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// Invert control!</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// Return a function that accepts `dispatch` so we can dispatch
        later.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// Thunk middleware knows how to turn thunk async actions into
        actions.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >fetchSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token parameter">sauce</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874">makeASandwich</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> sauce</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token parameter">error</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874">apologize</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e"
        >‘The Sandwich Shop’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> error</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// Thunk middleware lets me dispatch thunk async actions</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// as if they were actions!</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain">store</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘Me’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// It even takes care to return the thunk’s return value</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// from the dispatch, so I can chain Promises as long as I return
        them.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain">store</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘My wife’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token console class-name">console</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >log</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘Done!’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// In fact I can write action creators that dispatch</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// actions and async actions from other action creators,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// and I can build my control flow with Promises.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >makeSandwichesForEverybody</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">function</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">dispatch</span
      ><span class="token parameter punctuation" style="color: #f8f8f2">,</span
      ><span class="token parameter"> getState</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672">if</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token operator" style="color: #f8f8f2">!</span
      ><span class="token function" style="color: #e6d874">getState</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">sandwiches</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">isShopOpen</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// You don’t have to return Promises, but it’s a handy convention</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// so the caller can always call .then() on async dispatch
        result.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token known-class-name class-name">Promise</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >resolve</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// We can dispatch both plain object actions and other thunks,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token comment" style="color: #c6cad2"
        >// which lets us compose the asynchronous actions in a single
        flow.</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘My Grandma’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token known-class-name class-name">Promise</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >all</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">[</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘Me’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘My wife’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">]</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘Our kids’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">getState</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">myMoney</span
      ><span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">&gt;</span
      ><span class="token plain"> </span
      ><span class="token number" style="color: #ae81ff">42</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">?</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">withdrawMoney</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token number" style="color: #ae81ff">42</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">apologize</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘Me’</span
      ><span class="token punctuation" style="color: #f8f8f2">,</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e"
        >‘The Sandwich Shop’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// This is very useful for server side rendering, because I can
        wait</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// until data is available, then synchronously render the app.</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">{</span
      ><span class="token imports"> renderToString </span
      ><span class="token imports punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e"
        >‘react-dom/server’</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p><span class="token plain">store</span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeSandwichesForEverybody</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >then</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> response</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >send</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874">renderToString</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token operator" style="color: #f8f8f2">&lt;</span
      ><span class="token maybe-class-name">MyApp</span
      ><span class="token plain"> store</span
      ><span class="token operator" style="color: #f8f8f2">=</span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain">store</span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">/</span
      ><span class="token operator" style="color: #f8f8f2">&gt;</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// I can also dispatch a thunk async action from a component</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token comment" style="color: #c6cad2"
        >// any time its props change to load the missing data.</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">{</span
      ><span class="token imports"> connect </span
      ><span class="token imports punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘react-redux’</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">import</span
      ><span class="token plain"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">{</span
      ><span class="token imports"> </span
      ><span class="token imports maybe-class-name">Component</span
      ><span class="token imports"> </span
      ><span class="token imports punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">from</span
      ><span class="token plain"> </span
      ><span class="token string" style="color: #a6e22e">‘react’</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword" style="color: #f92672">class</span
      ><span class="token plain"> </span
      ><span class="token class-name">SandwichShop</span
      ><span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">extends</span
      ><span class="token plain"> </span
      ><span class="token class-name">Component</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >componentDidMount</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874"
        >componentDidUpdate</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">prevProps</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672">if</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token plain">prevProps</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">forPerson</span
      ><span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">!==</span
      ><span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >dispatch</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token function" style="color: #e6d874"
        >makeASandwichWithSecretSauce</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">forPerson</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">render</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token keyword control-flow" style="color: #f92672"
        >return</span
      ><span class="token plain"> </span
      ><span class="token operator" style="color: #f8f8f2">&lt;</span
      ><span class="token plain">p</span
      ><span class="token operator" style="color: #f8f8f2">&gt;</span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token keyword" style="color: #f92672">this</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">props</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">sandwiches</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span
        class="token method function property-access"
        style="color: #e6d874"
        >join</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token string" style="color: #a6e22e">‘mustard’</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token operator" style="color: #f8f8f2">&lt;</span
      ><span class="token operator" style="color: #f8f8f2">/</span
      ><span class="token plain">p</span
      ><span class="token operator" style="color: #f8f8f2">&gt;</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token plain"></span>
    </p>
    <p><span class="token plain" style="display: inline-block"> </span></p>
    <p>
      <span class="token plain"></span
      ><span class="token keyword module" style="color: #f92672">export</span
      ><span class="token plain"> </span
      ><span class="token keyword module" style="color: #f92672">default</span
      ><span class="token plain"> </span
      ><span class="token function" style="color: #e6d874">connect</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token parameter">state</span
      ><span class="token plain"> </span
      ><span class="token arrow operator" style="color: #f8f8f2">=&gt;</span
      ><span class="token plain"> </span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token punctuation" style="color: #f8f8f2">{</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"> sandwiches</span
      ><span class="token operator" style="color: #f8f8f2">:</span
      ><span class="token plain"> state</span
      ><span class="token punctuation" style="color: #f8f8f2">.</span
      ><span class="token property-access">sandwiches</span
      ><span class="token plain"></span>
    </p>
    <p>
      <span class="token plain"></span
      ><span class="token punctuation" style="color: #f8f8f2">}</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span
      ><span class="token punctuation" style="color: #f8f8f2">(</span
      ><span class="token maybe-class-name">SandwichShop</span
      ><span class="token punctuation" style="color: #f8f8f2">)</span>
    </p>
    <p>Copy</p>
    <h4 id="tips">
      <span id="tips" class="anchor enhancedAnchor_2LWZ"></span>Tips<a
        href="#tips"
        class="hash-link"
        title="Direct link to heading"
        >#</a
      >
    </h4>
    <ul>
      <li>
        <p>
          Middleware only wraps the store’s
          <a href="https://redux.js.org/api/store#dispatchaction"
            ><code class="language-js">dispatch</code></a
          >
          function. Technically, anything a middleware can do, you can do
          manually by wrapping every
          <code class="language-js">dispatch</code> call, but it’s easier to
          manage this in a single place and define action transformations on the
          scale of the whole project.
        </p>
      </li>
      <li>
        <p>
          If you use other store enhancers in addition to
          <code class="language-js">applyMiddleware</code>, make sure to put
          <code class="language-js">applyMiddleware</code> before them in the
          composition chain because the middleware is potentially asynchronous.
          For example, it should go before
          <a href="https://github.com/reduxjs/redux-devtools">redux-devtools</a>
          because otherwise the DevTools won’t see the raw actions emitted by
          the Promise middleware and such.
        </p>
      </li>
      <li>
        <p>
          If you want to conditionally apply a middleware, make sure to only
          import it when it’s needed:
        </p>
        <p>
          <span class="token keyword" style="color: #f92672">let</span
          ><span class="token plain"> middleware </span
          ><span class="token operator" style="color: #f8f8f2">=</span
          ><span class="token plain"> </span
          ><span class="token punctuation" style="color: #f8f8f2">[</span
          ><span class="token plain">a</span
          ><span class="token punctuation" style="color: #f8f8f2">,</span
          ><span class="token plain"> b</span
          ><span class="token punctuation" style="color: #f8f8f2">]</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"></span
          ><span class="token keyword control-flow" style="color: #f92672"
            >if</span
          ><span class="token plain"> </span
          ><span class="token punctuation" style="color: #f8f8f2">(</span
          ><span class="token plain">process</span
          ><span class="token punctuation" style="color: #f8f8f2">.</span
          ><span class="token property-access">env</span
          ><span class="token punctuation" style="color: #f8f8f2">.</span
          ><span class="token constant" style="color: #f92672">NODE_ENV</span
          ><span class="token plain"> </span
          ><span class="token operator" style="color: #f8f8f2">!==</span
          ><span class="token plain"> </span
          ><span class="token string" style="color: #a6e22e">‘production’</span
          ><span class="token punctuation" style="color: #f8f8f2">)</span
          ><span class="token plain"> </span
          ><span class="token punctuation" style="color: #f8f8f2">{</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> </span
          ><span class="token keyword" style="color: #f92672">const</span
          ><span class="token plain"> c </span
          ><span class="token operator" style="color: #f8f8f2">=</span
          ><span class="token plain"> </span
          ><span class="token function" style="color: #e6d874">require</span
          ><span class="token punctuation" style="color: #f8f8f2">(</span
          ><span class="token string" style="color: #a6e22e"
            >‘some-debug-middleware’</span
          ><span class="token punctuation" style="color: #f8f8f2">)</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> </span
          ><span class="token keyword" style="color: #f92672">const</span
          ><span class="token plain"> d </span
          ><span class="token operator" style="color: #f8f8f2">=</span
          ><span class="token plain"> </span
          ><span class="token function" style="color: #e6d874">require</span
          ><span class="token punctuation" style="color: #f8f8f2">(</span
          ><span class="token string" style="color: #a6e22e"
            >‘another-debug-middleware’</span
          ><span class="token punctuation" style="color: #f8f8f2">)</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> middleware </span
          ><span class="token operator" style="color: #f8f8f2">=</span
          ><span class="token plain"> </span
          ><span class="token punctuation" style="color: #f8f8f2">[</span
          ><span class="token spread operator" style="color: #f8f8f2">…</span
          ><span class="token plain">middleware</span
          ><span class="token punctuation" style="color: #f8f8f2">,</span
          ><span class="token plain"> c</span
          ><span class="token punctuation" style="color: #f8f8f2">,</span
          ><span class="token plain"> d</span
          ><span class="token punctuation" style="color: #f8f8f2">]</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"></span
          ><span class="token punctuation" style="color: #f8f8f2">}</span
          ><span class="token plain"></span>
        </p>
        <p><span class="token plain" style="display: inline-block"> </span></p>
        <p>
          <span class="token plain"></span
          ><span class="token keyword" style="color: #f92672">const</span
          ><span class="token plain"> store </span
          ><span class="token operator" style="color: #f8f8f2">=</span
          ><span class="token plain"> </span
          ><span class="token function" style="color: #e6d874">createStore</span
          ><span class="token punctuation" style="color: #f8f8f2">(</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> reducer</span
          ><span class="token punctuation" style="color: #f8f8f2">,</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> preloadedState</span
          ><span class="token punctuation" style="color: #f8f8f2">,</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"> </span
          ><span class="token function" style="color: #e6d874"
            >applyMiddleware</span
          ><span class="token punctuation" style="color: #f8f8f2">(</span
          ><span class="token spread operator" style="color: #f8f8f2">…</span
          ><span class="token plain">middleware</span
          ><span class="token punctuation" style="color: #f8f8f2">)</span
          ><span class="token plain"></span>
        </p>
        <p>
          <span class="token plain"></span
          ><span class="token punctuation" style="color: #f8f8f2">)</span>
        </p>
        <p>Copy</p>
        <p>
          This makes it easier for bundling tools to cut out unneeded modules
          and reduces the size of your builds.
        </p>
      </li>
      <li>
        <p>
          Ever wondered what
          <code class="language-js">applyMiddleware</code> itself is? It ought
          to be an extension mechanism more powerful than the middleware itself.
          Indeed, <code class="language-js">applyMiddleware</code> is an example
          of the most powerful Redux extension mechanism called
          <a
            href="https://redux.js.org/understanding/thinking-in-redux/glossary#store-enhancer"
            >store enhancers</a
          >. It is highly unlikely you’ll ever want to write a store enhancer
          yourself. Another example of a store enhancer is
          <a href="https://github.com/reduxjs/redux-devtools">redux-devtools</a
          >. Middleware is less powerful than a store enhancer, but it is easier
          to write.
        </p>
      </li>
      <li>
        <p>
          Middleware sounds much more complicated than it really is. The only
          way to really understand middleware is to see how the existing
          middleware works, and try to write your own. The function nesting can
          be intimidating, but most of the middleware you’ll find are, in fact,
          10-liners, and the nesting and composability is what makes the
          middleware system powerful.
        </p>
      </li>
      <li>
        <p>
          To apply multiple store enhancers, you may use
          <a href="https://redux.js.org/api/compose"
            ><code class="language-js">compose()</code></a
          >.
        </p>
      </li>
    </ul>
    <p>
      <a
        href="https://redux.js.org/api/combinereducers"
        class="pagination-nav__link"
      ></a>
    </p>

    <p>« combineReducers</p>
    <p>
      <a
        href="https://redux.js.org/api/bindactioncreators"
        class="pagination-nav__link"
      ></a>
    </p>

    <p>bindActionCreators »</p>
  </body>
</html>
